<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Geo Coordinates Conversion</title>
<link rel="icon" href="data:,">

<style>
* {
  font-family: Helvetica, Arial, sans-serif;
}

section {
  margin: 1em 0;
  max-width: 300px;
}

h1, .crs-chooser {
  cursor: pointer;
}

h1 {
  margin: 0.1em 0;
}

h1 .label {
  display: inline-block;
  width: 3.2em;
}

.paused .pause,
.tracking .track {
  display: none;
}

</style>

</head>
<body class="paused">

<header>
<button class="track">Track</button><button class="pause">Pause</button> <button class="settings">Settings</button>
</header>

<section id="coords-1">
<div class="crs-chooser">
EPSG:4326 (WGS-84) <button class="info">i</button>
</div>
<h1 class="coords-east"><span class="label">East:</span> <span class="value">0.000000</span><span class="unit">°</span></h1>
<h1 class="coords-north"><span class="label">North:</span> <span class="value">0.000000</span><span class="unit">°</span></h1>
</section>

<section id="coords-2">
<div class="crs-chooser">
EPSG:31256 (Austria GK East) <button class="info">i</button>
</div>
<h1 class="coords-east"><span class="label">East:</span> <span class="value">000000.00</span><span class="unit">m</span></h1>
<h1 class="coords-north"><span class="label">North:</span> <span class="value">000000.00</span><span class="unit">m</span></h1>
</section>

<script type="module">

async function importUMD(url, module = {exports:{}}) {
  return (Function('module', 'exports', await (await fetch(url)).text()).call(module, module, module.exports), module).exports;
}
// works, but loads hundreds of small files
// ==> load UMD packaged module instead  
//import proj from "https://unpkg.com/proj4@2.9.0/lib/index.js?module";
const proj = await importUMD("https://unpkg.com/proj4@2.9.0/dist/proj4-src.js");

document.querySelector("button.track").addEventListener("click", e => {
  document.body.classList.remove("paused");
  document.body.classList.add("tracking");
});

document.querySelector("button.pause").addEventListener("click", e => {
  document.body.classList.remove("tracking");
  document.body.classList.add("paused");
});

Promise.all([
  fetch("https://unpkg.com/epsg-index@1.3.0/s/4326.json").then(r => r.json()),
  fetch("https://unpkg.com/epsg-index@1.3.0/s/31256.json").then(r => r.json())
]).then(([fromCRS, toCRS]) => {
  //console.log(fromCRS.name);
  console.log(toCRS);
  
  let fromCoords = [16.3738, 48.2082];
  let coords = proj(toCRS.proj4, fromCoords);
  
  console.log(coords);
  
  document.querySelector("#coords-1 .coords-east .value").textContent = fromCoords[0].toFixed(5);
  document.querySelector("#coords-1 .coords-north .value").textContent = fromCoords[1].toFixed(5);
  
  document.querySelector("#coords-2 .coords-east .value").textContent = coords[0].toFixed(2);
  document.querySelector("#coords-2 .coords-north .value").textContent = coords[1].toFixed(2);
  
});

</script>
</body>
</html>